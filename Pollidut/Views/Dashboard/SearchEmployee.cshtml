<style>
    #imgPreviewWithStyles {
    background: #222;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    padding: 15px;
    z-index: 999;
    border: none;
}

/* Text below image */
#imgPreviewWithStyles span {
    color: white;
    text-align: center;
    display: block;
    padding: 10px 0 3px 0;
}

</style>


 @*Searching criteria*@
    <div class="row" id="search-criteria-class">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>
                    <span>Search Employee</span>
                </h4>
             @*   <span id="pie-chart-loader" class="loader">
                    <img src="../../assets/images/loaders/circular/059.gif" width="16" height="16" alt="" /></span>*@
                <a href="#" class="minimize">Minimize</a>
            </div>
            <div class="panel-body">

                <form class="form-horizontal" id="form-search-employee" action="~/Dashboard/SearchEmployeeResult">
                    
                    @*distributionhouseid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="distributionhouseid">Distribution House</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="distributionhouseid" name="distributionhouseid" style="width: 100%;" autofocus>
                                <option></option>
                                @foreach (var house in ViewBag.Houses)
                                {
                                    <option value="@house.DistributionHouseId">@house.DistributionHouseName</option>
                                }
                            </select>
                        </div>
                    </div>

                    @*personcurrentstatusid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="personcurrentstatusid">Person Current Status</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="personcurrentstatusid" name="personcurrentstatusid" style="width: 100%;">
                                <option></option>
                             
                                <option value="1">In service</option>
                                <option value="2">Not in service</option>
                            </select>
                        </div>
                    </div>

                    @*active*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="active">Active</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="active" name="active" style="width: 100%;">
                                <option></option>
                                <option value="1">Yes</option>
                                <option value="0">No</option>
                            </select>
                        </div>
                    </div>

                    @*employeecode*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="employeecode">Employee Code</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="employeecode" name="employeecode" type="text" />
                        </div>
                    </div>

                    @*personname*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="personname">Employee Name</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="personname" name="personname" type="text" title="Employee Name."  />
                        </div>
                    </div>

                    @*mobileno*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="mobileno">Mobile No.</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="mobileno" name="mobileno" type="text" />
                        </div>
                    </div>

                    @*email*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="email">Email</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="email" name="email" type="text" />
                        </div>
                    </div>

                    @*nid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="nid">NID</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="nid" name="nid" type="text" />
                        </div>
                    </div>


                    @*designationid*@
@*                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="designationid">Designation</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="designationid" name="designationid" style="width: 100%;">
                                <option></option>
                                @foreach (var des in ViewBag.Designations)
                                {
                                    <option value="@des.DesignationId">@des.DesignationName</option>
                                }
                            </select>
                        </div>
                    </div>*@
             
                    @*dateofbirth*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromdateofbirth">Date of Birth</label>
                        <div class="col-lg-9">
                          From <input class="form-control datepicker nostyle" style="width:20%;" id="fromdateofbirth" name="fromdateofbirth" type="text" placeholder="dd-mm-yyyy" />
                          To <input class="form-control datepicker nostyle" style="width:20%;" id="todateofbirth" name="todateofbirth" type="text" placeholder="dd-mm-yyyy" />
                        
                        </div>
                         
                    </div>

                    @*genderid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="genderid">Gender</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="genderid" name="genderid" style="width: 100%;">
                                <option></option>
                                <option value="1">Male</option>
                                <option value="2">Female</option>
                            </select>
                        </div>
                    </div>

                    @*marritalstatusid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="genderid">Marrital Status</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="marritalstatusid" name="marritalstatusid" style="width: 100%;">
                                <option></option>
                                <option value="1">Single</option>
                                <option value="2">Married</option>
                            </select>
                        </div>
                    </div>

                    @*districtid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="districtid">District</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="districtid" name="districtid" style="width: 100%;">
                                <option></option>
                                @foreach (var district in ViewBag.Districts)
                                {
                                    <option value="@district.DistrictId">@district.DistrictName</option>
                                }
                            </select>
                        </div>
                    </div>

                    @*employeetypeid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="employeetypeid">Employee Type</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="employeetypeid" name="employeetypeid" style="width: 100%;">
                                <option></option>
                                @foreach (var type in ViewBag.EmployeeTypes)
                                {
                                    <option value="@type.EmployeeTypeId">@type.EmployeeTypeName</option>
                                }
                            </select>
                        </div>
                    </div>

                    @*startdate*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromstartdate">Start Date</label>
                        <div class="col-lg-9">
                          from  <input class="form-control datepicker nostyle" id="fromstartdate" name="fromstartdate" type="text" placeholder="dd-mm-yyyy" />
                          to  <input class="form-control datepicker nostyle" id="tostartdate" name="tostartdate" type="text" placeholder="dd-mm-yyyy" />

                        </div>
                    </div>

                    @*enddate*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromenddate">End Date</label>
                        <div class="col-lg-9">
                           from <input class="form-control datepicker nostyle" id="fromenddate" name="fromenddate" type="text" placeholder="dd-mm-yyyy" />
                           to <input class="form-control datepicker nostyle" id="toenddate" name="toenddate" type="text" placeholder="dd-mm-yyyy" />

                        </div>
                    </div>

                    @*Buttons*@
                    <div class="form-group">
                        <div class="col-lg-offset-3 col-lg-9">
                            <button type="submit" id="btn-submit-mainform" class="btn btn-success btn-lg">Search</button>
                            <button type="button" id="btn-reset-mainform" class="btn btn-info btn-lg">Reset</button>
                        </div>
                    </div>
                </form>


            </div>

        </div>
    </div>
</div>
 @*Searching criteria*@

 @*Search result*@
<div class="row" id="search-result-class">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>
                    <span id="search-result-count">Search Result</span>  <a href="#" class="pull-right" id="back-to-search">Back to search &nbsp;</a>
                </h4>
          
                <a href="#" class="minimize">Minimize</a>
            </div>
            <div class="panel-body noPad">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>House Name</th>
                        <th>Emp. Code</th>
                        <th>Photo</th>
                        <th>Employee Name</th>
                        <th>Employee Type</th>
                        <th>Active</th>
                        <th>Mobile</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            </div>
        </div>
    </div>
</div>

    <!-- Select2 plugin -->
    <script>
        $(document).ready(function () {
            //  $('#distributionhouseid').select2({ placeholder: "Select a house." });

            $('#search-result-class').hide();
            $('#back-to-search').click(function () {

                $('#search-result-class').hide();
                $('#search-criteria-class').show();

            });
            $('.limit').inputlimiter({ limit: 100 });
        });
    </script>

    <!-- date time picker -->
    <script type="text/javascript">
        $(function () {
            $(".datepicker").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd-mm-yy',
                yearRange: "-70:+0"
            });
        });
    </script>


    <!-- Validation -->
    <script type="text/javascript">
        // document ready function
        $(document).ready(function () {

            //Validator date chech method
            $.validator.addMethod("dateCheck", function (value, element) {
                var dateValue = $("#AccountOpeningDate").val();
                var validDatePattern = /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/;

                if (validDatePattern.test(dateValue)) {
                    return true;
                }
                else {
                    return false;
                }

            }, 'Invalid date.');


            //Date check method
            function IsDateValid(element) {
               
                var dateValue = $(element).val();

                if (dateValue == '') {
                    return true;
                }
                else {
                    var validDatePattern = /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/;
                    if (validDatePattern.test(dateValue)) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }

            }



            $("input, textarea, select").not('.nostyle').uniform();

            //form validation
            var form = $('#form-search-employee');
            form.validate({
                submitHandler: function () {

                    var fromDateOfBirth = $('#fromdateofbirth');
                    if (IsDateValid(fromDateOfBirth)) {
                      
                    }
                    else {
                        alert('Invalid date.'); fromDateOfBirth.focus(); return;
                    }

                    var todateofbirth = $('#todateofbirth');
                    if (IsDateValid(todateofbirth)) {
                      
                    }
                    else {
                        alert('Invalid date.'); todateofbirth.focus(); return;
                    }

                    var startDate = $('#fromdateofbirth').val().replace('-', '/');
                    var endDate = $('#todateofbirth').val().replace('-', '/');

                    if (startDate != '' && endDate != '') {
                        if (startDate > endDate) {
                            alert('Invalid date range.');
                            $('#fromdateofbirth').focus();
                            return;
                        }
                    }



                    var fromstartdate = $('#fromstartdate');
                    if (IsDateValid(fromstartdate)) {

                    }
                    else {
                        alert('Invalid date.'); fromstartdate.focus(); return;
                    }
                    
                    var tostartdate = $('#tostartdate');
                    if (IsDateValid(tostartdate)) {

                    }
                    else {
                        alert('Invalid date.'); tostartdate.focus(); return;
                    }
                    

                    var fromenddate = $('#fromenddate');
                    if (IsDateValid(fromenddate)) {

                    }
                    else {
                        alert('Invalid date.'); fromenddate.focus(); return;
                    }
           
                    var toenddate = $('#toenddate');
                    if (IsDateValid(toenddate)) {

                    }
                    else {
                        alert('Invalid date.'); toenddate.focus(); return;
                    }





                    SubmitEmployeeSearchForm(form);
                },
                ignore: null,
                rules: {
                    employeecode: { number: true }
                    //FormNo: {required: true, number: true},
                    //OkAccountNo: { required: true, number: true, minlength: 12, maxlength: 12 },
                    //AgentName: { required: true, minlength: 4 },
                    //BusinessAddress: { required: true },
                    //BusinessDistrictId: { required: true },
                    //BusinessThanaId: { required: true},
                    //OwnerName: { required: true },
                    //MobileNo: { required: true, number: true, minlength: 11, maxlength: 11 },
                    //AccountOpeningDate: { required: true, dateCheck: true }
                },
                messages: {
                    employeecode: { number: "It must be numeric." }
                    //FormNo: {required: "Please enter Form No.", number: "It must be numeric."},
                    //OkAccountNo: { required: "Required", number: "must be numeric", minlength: "minimum length 12.", maxlength: "Invalid" },
                    //AgentName: { required: "Required.", minlength: "not valid." },
                    //BusinessAddress: { required: "required." },
                    //BusinessDistrictId: { required: "select a district." },
                    //BusinessThanaId: { required: "select a thana." },
                    //OwnerName: { required: "Enter owner name." },
                    //MobileNo: { required: "Required", number: "must be numeric", minlength: "minimum length 11.", maxlength: "max 11" },
                    //AccountOpeningDate: { required: "Enter date.", dateCheck: "Invalid date." }
                }
                //invalidHandler: function (event, validator) {
                //    // 'this' refers to the form
                //    var errors = validator.numberOfInvalids();
                //    if (errors) {
                //        alert(errors);
                //    } else {

                //    }
                //}
            });


            //Employee Form Submit Handler
            function SubmitEmployeeSearchForm(MainForm) {

                var SubmitURL = MainForm.attr('action');
                var FormData = MainForm.serialize();
                $.ajax({
                    type: "POST",
                    url: SubmitURL,
                    async: true,
                    //If datatype is of 'FormCollection', following 3 lines are not needed-
                    //====================================================
                    //contentType: "application/json; charset=utf-8",
                    //data: "{'agentdata':'"+ agentdata +"'}",
                    //dataType: 'json',
                    //====================================================
                    data: FormData,
                    beforeSend: function () {
                        $(MainForm).find('.btn').attr('disabled', 'disabled');
                        $(MainForm).find('#btn-submit-mainform').html('Working...');
                    },
                    success: function (result) {
                        var parsed = JSON.parse(result);
                        console.log(parsed);

                        var rowCount = parsed.length;

                        if (rowCount>0) {
                            $('#search-result-count').html(parsed.length + ' persons found.');

                            $('tbody').empty();
                            parsed.forEach(function (row) {
                                var isActive = (row.IsActive == 1 ? "Yes" : "No");
                                $('tbody').append('<tr><td>' + row.DistributionHouseName + '</td><td>' + row.EmployeeCode + '</td><td><a class="employee-thumb" href="img/../../../Photos/EmployeePhotos/' + row.Photo + '".jpg"><img width="30px" class="img-rounded" src="../../Photos/EmployeePhotos/' + row.Photo + '"/></a></td><td style="text-align:left;" class="person-name-td">' + row.PersonName + '</td><td>' + row.EmployeeTypeName + '</td><td>' + isActive + '</td><td>' + row.Mobile + '</td><td><a target="_blank" href="../../../Employee/EmployeeDetail?id=' + row.EmployeeId + '" class="btn btn-info btn-sm">Details</a></td></tr>');
                            });

                            $('.employee-thumb').imgPreview({
                                containerID: 'imgPreviewWithStyles',
                                imgCSS: {
                                    // Limit preview size:
                                    height: 150
                                },
                                // When container is shown:
                                //onShow: function (link) {
                                //    $('<span>' + $('.employee-thumb').closest('tr').find('.person-name-td').html() + '</span>').appendTo(this);
                                //},
                                // When container hides: 
                                onHide: function (link) {
                                    $('span', this).remove();
                                }
                            });

                            $('table').show();
                        }
                        else {
                            $('table').hide();
                            $('#search-result-count').html('not found.');
                        }

                        $(MainForm).find('.btn').removeAttr("disabled");
                        $(MainForm).find('#btn-submit-mainform').html('Search');

                        $('#search-criteria-class').hide();
                        $('#search-result-class').show();
                    },
                    error: function (request, status, error) {
                        ShowRegularError("Failed to search. Error Details -  Request: " + request + ", Status: " + status + ", Error: " + error);
                        //alert("Failed to save. Error Details -  Request: " + request + ", Status: " + status + ", Error: " + error);
                    },
                    complete: function () {
                       

                    }
                });
                return false;
            }





        });
        </script>



