<style>
    #imgPreviewWithStyles {
    background: #222;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    padding: 15px;
    z-index: 999;
    border: none;
}

/* Text below image */
#imgPreviewWithStyles span {
    color: white;
    text-align: center;
    display: block;
    padding: 10px 0 3px 0;
}

</style>


 @*Searching criteria*@
    <div class="row" id="search-criteria-class">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>
                    <span>Search Employee</span>
                </h4>
             @*   <span id="pie-chart-loader" class="loader">
                    <img src="../../assets/images/loaders/circular/059.gif" width="16" height="16" alt="" /></span>*@
                <a href="#" class="minimize">Minimize</a>
            </div>
            <div class="panel-body">

                <form class="form-horizontal" id="form-search-employee" action="~/Dashboard/EditEmployeeResult">
                    
                    @*distributionhouseid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="distributionhouseid">Distribution House</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="distributionhouseid" name="distributionhouseid" style="width: 100%;" autofocus>
                                <option></option>
                                @foreach (var house in ViewBag.Houses)
                                {
                                    <option value="@house.DistributionHouseId">@house.DistributionHouseName</option>
                                }
                            </select>
                        </div>
                    </div>

                  
                    @*active*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="active">Active</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="active" name="active" style="width: 100%;">
                                <option></option>
                                <option value="1">Yes</option>
                                <option value="0">No</option>
                            </select>
                        </div>
                    </div>

                    @*employeecode*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="employeecode">Employee Code</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="employeecode" name="employeecode" type="text" />
                        </div>
                    </div>

                    @*personname*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="personname">Employee Name</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="personname" name="personname" type="text" title="Employee Name."  />
                        </div>
                    </div>

                    @*mobileno*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="mobileno">Mobile No.</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="mobileno" name="mobileno" type="text" />
                        </div>
                    </div>

                   
                    @*nid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="nid">NID</label>
                        <div class="col-lg-9">
                            <input class="form-control nostyle" id="nid" name="nid" type="text" />
                        </div>
                    </div>

                    @*dateofbirth*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromdateofbirth">Date of Birth</label>
                        <div class="col-lg-9">
                          Before <input class="form-control datepicker nostyle" style="width:20%;" id="fromdateofbirth" name="fromdateofbirth" type="text" placeholder="dd-mm-yyyy" />
                          After <input class="form-control datepicker nostyle" style="width:20%;" id="todateofbirth" name="todateofbirth" type="text" placeholder="dd-mm-yyyy" />
                        
                        </div>
                         
                    </div>

                    @*genderid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="genderid">Gender</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="genderid" name="genderid" style="width: 100%;">
                                <option></option>
                                <option value="1">Male</option>
                                <option value="2">Female</option>
                            </select>
                        </div>
                    </div>

                    @*marritalstatusid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="genderid">Marrital Status</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="marritalstatusid" name="marritalstatusid" style="width: 100%;">
                                <option></option>
                                <option value="1">Single</option>
                                <option value="2">Married</option>
                            </select>
                        </div>
                    </div>

                    @*districtid*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="districtid">District</label>
                        <div class="col-lg-9">
                            <select class="nostyle form-control resetIt" id="districtid" name="districtid" style="width: 100%;">
                                <option></option>
                                @foreach (var district in ViewBag.Districts)
                                {
                                    <option value="@district.DistrictId">@district.DistrictName</option>
                                }
                            </select>
                        </div>
                    </div>

                 

                    @*startdate*@
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromstartdate">Joining Date</label>
                        <div class="col-lg-9">
                          before  <input class="form-control datepicker nostyle" id="fromstartdate" name="fromstartdate" type="text" placeholder="dd-mm-yyyy" />
                          after  <input class="form-control datepicker nostyle" id="tostartdate" name="tostartdate" type="text" placeholder="dd-mm-yyyy" />

                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-lg-3 control-label" for="fromstartdate">Minimun Investment</label>
                        <div class="col-lg-9">
                            Greater Than  <input class="form-control  nostyle" id="greaterInvest" name="greaterInvest" type="text"  />
                            Less Than  <input class="form-control  nostyle" id="lessInverst" name="lessInverst" type="text"  />
                        </div>
                    </div>

                   

                    @*Buttons*@
                    <div class="form-group">
                        <div class="col-lg-offset-3 col-lg-9">
                            <button type="submit" id="btn-submit-mainform" class="btn btn-success btn-lg">Search</button>
                            <button type="button" id="btn-reset-mainform" class="btn btn-info btn-lg">Reset</button>
                        </div>
                    </div>
                </form>


            </div>

        </div>
    </div>
</div>
 @*Searching criteria*@

 @*Search result*@
<div class="row" id="search-result-class">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>
                    <span id="search-result-count">Search Result</span>  <a href="#" class="pull-right" id="back-to-search">Back to search &nbsp;</a>
                </h4>
          
                <a href="#" class="minimize">Minimize</a>
            </div>
            <div class="panel-body noPad">
            <table id="searchResult" class="table table-bordered">
                <thead>
                    <tr>
                        <th>House Name</th>
                        <th>Emp. Code</th>
                        <th>Employee Name</th>
                        <th>Mobile</th>
                        <th>Photo</th>
                        <th>Mimimun Investment</th>
                        <th>Active</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            </div>
        </div>
    </div>
</div>



@*<script>
    $(function () {
        $('#searchResult').on('click', '.btnEmpDetail', function () {
            var eid = $(this).closest('td').find('.eId').val();
            var urlData = "/Employee/getEmployeeDetails?id=" + eid;
            $.ajax({
                url: urlData,
                async: true,
                success: function (data) {
                    $('#empDetailPanel').html(data).fadeIn('slow');
                },
                error: function (request, status, error) {
                    alert("Error-  Request: " + request + ", Status: " + status + ", Error: " + error);
                },
                complete: function () {

                }
            });
        });
    });
</script>*@
    <!-- Select2 plugin -->
    <script>
        $(document).ready(function () {
            //  $('#distributionhouseid').select2({ placeholder: "Select a house." });

            $('#search-result-class').hide();
            $('#back-to-search').click(function () {

                $('#search-result-class').hide();
                $('#search-criteria-class').show();

            });
            $('.limit').inputlimiter({ limit: 100 });
        });
    </script>

    <!-- date time picker -->
    <script type="text/javascript">
        $(function () {
            $(".datepicker").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd-mm-yy',
                yearRange: "-70:+0"
            });
        });
    </script>


    <!-- Validation -->
    <script type="text/javascript">
        // document ready function
        $(document).ready(function () {
            //Date check method
            function IsDateValid(element) {
               
                var dateValue = $(element).val();

                if (dateValue == '') {
                    return true;
                }
                else {
                    var validDatePattern = /^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/;
                    if (validDatePattern.test(dateValue)) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }

            }



            $("input, textarea, select").not('.nostyle').uniform();

            //form validation
            var form = $('#form-search-employee');
            form.validate({
                submitHandler: function () {

                    var fromDateOfBirth = $('#fromdateofbirth');
                    if (IsDateValid(fromDateOfBirth)) {
                      
                    }
                    else {
                        alert('Invalid date.'); fromDateOfBirth.focus(); return;
                    }

                    var todateofbirth = $('#todateofbirth');
                    if (IsDateValid(todateofbirth)) {
                      
                    }
                    else {
                        alert('Invalid date.'); todateofbirth.focus(); return;
                    }

                    var startDate = $('#fromdateofbirth').val().replace('-', '/');
                    var endDate = $('#todateofbirth').val().replace('-', '/');

                    if (startDate != '' && endDate != '') {
                        if (startDate < endDate) {
                            alert('Invalid Birth date range.');
                            $('#fromdateofbirth').focus();
                            return;
                        }
                    }



                    var fromstartdate = $('#fromstartdate');
                    if (IsDateValid(fromstartdate)) {

                    }
                    else {
                        alert('Invalid date.'); fromstartdate.focus(); return;
                    }
                    
                    var tostartdate = $('#tostartdate');
                    if (IsDateValid(tostartdate)) {

                    }
                    else {
                        alert('Invalid date.'); tostartdate.focus(); return;
                    }

                    var beforeJoinDate = $('#fromstartdate').val().replace('-', '/');
                    var afterJoinDate = $('#tostartdate').val().replace('-', '/');

                    if (beforeJoinDate != '' && afterJoinDate != '') {
                        if (beforeJoinDate < afterJoinDate) {
                            alert('Invalid Join date range.');
                            $('#fromstartdate').focus();
                            return;
                        }
                    }
                    var greaterInvest = $('#greaterInvest').val();
                    var lessInvest = $('#lessInverst').val();
                    if (greaterInvest != '' && lessInvest != '') {
                        if (greaterInvest > lessInvest) {
                            alert('Invalid Investment range.');
                            $('#greaterInvest').focus();
                            return;
                        }
                    }
                    
                    SubmitEmployeeSearchForm(form);
                },
                ignore: null,
                rules: {
                    greaterInvest: { number: true },
                    lessInverst: { number: true },
                    mobileno: { number: true },
                    nid: { number: true }
                },
                messages: {
                    greaterInvest: { number: "It must be numeric." },
                    lessInverst: { number: "It must be numeric." },
                    mobileno: { number: "It must be numeric." },
                    nid: { number: "It must be numeric." }
                }
                
            });


            //Employee Form Submit Handler
            function SubmitEmployeeSearchForm(MainForm) {

                var SubmitURL = MainForm.attr('action');
                var FormData = MainForm.serialize();
                $.ajax({
                    type: "POST",
                    url: SubmitURL,
                    async: true,
                    //If datatype is of 'FormCollection', following 3 lines are not needed-
                    //====================================================
                    //contentType: "application/json; charset=utf-8",
                    //data: "{'agentdata':'"+ agentdata +"'}",
                    //dataType: 'json',
                    //====================================================
                    data: FormData,
                    beforeSend: function () {
                        $(MainForm).find('.btn').attr('disabled', 'disabled');
                        $(MainForm).find('#btn-submit-mainform').html('Working...');
                    },
                    success: function (result) {
                        if (result.msg == "success") {
                            $('tbody').empty();
                            $.each(result.data, function () {
                                var isActive = (this.Active == true ? "Yes" : "No");
                                $('tbody').append('<tr><td>' + this.DistributionHouse + '</td><td>' + this.EmpCode + '</td><td style="text-align:left;" class="person-name-td">' + this.EmpName + '</td><td>' + this.MobileNo + '</td><td><a class="employee-thumb" href="img/../../../Photos/EmployeePhotos/' + this.Photo + '".jpg"><img width="30px" class="img-rounded" src="../../Photos/EmployeePhotos/' + this.Photo + '"/></a></td><td>' + this.MiminumInvest + '</td><td>' + isActive + '</td><td><a target="_blank" href="../../../Employee/getEmployeeDetails?id=' + this.EmployeeId + '" class="btn btn-info btn-sm">Details</a></td></tr>');
                            });
                            $('.employee-thumb').imgPreview({
                                containerID: 'imgPreviewWithStyles',
                                imgCSS: {
                                    // Limit preview size:
                                    height: 150
                                },
                                // When container is shown:
                                //onShow: function (link) {
                                //    $('<span>' + $('.employee-thumb').closest('tr').find('.person-name-td').html() + '</span>').appendTo(this);
                                //},
                                // When container hides: 
                                onHide: function (link) {
                                    $('span', this).remove();
                                }
                            });

                            $('table').show();
                        }
                        else {
                            $('table').hide();
                            $('#search-result-count').html('not found.');
                        }
                        $(MainForm).find('.btn').removeAttr("disabled");
                        $(MainForm).find('#btn-submit-mainform').html('Search');

                        $('#search-criteria-class').hide();
                        $('#search-result-class').show();
                    },
                    error: function (request, status, error) {
                        ShowRegularError("Failed to search. Error Details -  Request: " + request + ", Status: " + status + ", Error: " + error);
                        //alert("Failed to save. Error Details -  Request: " + request + ", Status: " + status + ", Error: " + error);
                    },
                    complete: function () {

                    }
                });
                return false;
            }
        });
        </script>



